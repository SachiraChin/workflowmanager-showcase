# Issue: InteractionRequest.prompt Rendered in Non-Scrollable Host Container

## Summary

<!-- Problem is not this, its not about container being scrollable or not, it about prompt field is rendered in host container. Host container only meant to have title and description, then its children. So, problem is how prompt is added to InteractionRequest and then how its incorrectly used in client. So, what I wanted is not to fix scrolling for prompt, what I wanted from you was that to find how this is used in oms workflow and how it came to be in the first place. What incorrect decisions made to become this field available? Is this really needed? If needed, how we can fix this, we have recursive component design mechanism, and each child is atomic components meant to do specific things, given that, where this prompt belong. Do your research again and write r2. -->
The `prompt` field in `InteractionRequest` is rendered by `InteractionHost` (the parent container) in a fixed-height, non-scrollable header section. When modules use `prompt` for long content (e.g., `user.pause` displaying aesthetic prompt sections), the text overflows the container instead of being scrollable.

## Architecture Reference

- `contracts/interactions.py`: Defines `InteractionRequest` with `prompt: Optional[str]` field
- `webui/src/components/workflow/interactions/InteractionHost.tsx`: Renders `prompt` in header
- `server/modules/user/*.py`: All user modules set `prompt` in their `InteractionRequest`

## Expected Behavior

Long content should be contained within the interaction panel with scrollbars, following the same pattern used by `SchemaInteractionHost`:

```tsx
// SchemaInteractionHost.tsx:167 - correct pattern
<div className="flex-1 min-h-0 overflow-y-auto scrollbar-inner pr-2">
```

## Actual Behavior

`InteractionHost.tsx:106-116` renders `prompt` in a fixed header with `flex-shrink-0`:

```tsx
{(request.title || request.prompt) && (
  <div className="flex-shrink-0 pb-4">
    {request.title && (
      <h3 className="text-lg font-semibold">{request.title}</h3>
    )}
    {request.prompt && (
      <p className="text-base text-foreground/80 whitespace-pre-line mt-1">
        {request.prompt}
      </p>
    )}
  </div>
)}
```

This means `prompt` cannot shrink or scroll, causing overflow when content is long.

## Root Cause Analysis

The `prompt` field is semantically overloaded - it's used for two different purposes:

1. **Short instructional text** (intended use): "Select the theme for your content"
2. **Long-form content display** (misuse): Multi-line aesthetic prompt sections preview

The architecture places `prompt` rendering in `InteractionHost` (the base container), not in child components. This made sense for short instructions but fails for long content.

### Server Modules Setting `prompt`

| Module | File | Line | How `prompt` is Set |
|--------|------|------|---------------------|
| `user.text_input` | `text_input.py` | 175 | `prompt=prompt` (from input) |
| `user.pause` | `pause.py` | 141 | `prompt=full_message` (concatenated message + debug info) |
| `user.form` | `form.py` | 148 | `prompt=prompt` (from input) |
| `user.select` | `select.py` | 180 | `prompt=prompt` (from input) |
| `user.file_input` | `file_input.py` | 125 | `prompt=prompt` (from input) |

### OMS Workflow Usage

**Short prompts (correct usage):**

| Step | Module | Prompt Content |
|------|--------|----------------|
| 1_user_input | `user.select` | "Select the emotional tone(s) for your video" |
| 1_user_input | `user.select` | "Select the theme for your content" |
| 1_user_input | `user.select` | "Select brightness level" |
| 1_user_input | `user.select` | "Select visual style" |
| 1_user_input | `user.select` | "Select motion strength" |
| 1_user_input | `user.text_input` | "Optional: Enter any specific direction..." |
| 1_user_input | `user.form` | "Select Core Aesthetics and specify count for each" |
| 3_image_analysis | `user.file_input` | "Enter image file path" |

**Long content (problematic usage):**

| Step | Module | Name | Content |
|------|--------|------|---------|
| 1_user_input | `user.pause` | `preview_aesthetic_prompt` | `"Generated Aesthetic Prompt Sections:\n\n{{ state.aesthetic_prompt_sections }}"` - **OVERFLOWS** |

**No explicit prompt (uses default):**

Many `user.select` instances in steps 2-8 don't specify a prompt, using the module's default.

## Impact

- `preview_aesthetic_prompt` interaction shows aesthetic prompt sections that overflow below the card
- User cannot scroll to see full content
- Any module putting long content in `prompt` will have the same issue

## Proposed Solutions

### Option A: Move `prompt` Rendering to Child Components

**Change:** Remove `prompt` rendering from `InteractionHost`, have each child component render its own prompt in its scrollable content area.

**Pros:**
- Each component controls its own layout
- Consistent with how `SchemaInteractionHost` handles content
- No semantic change to `InteractionRequest`

**Cons:**
- Requires updating all interaction components
- Duplicates prompt rendering logic across components

**Files affected:**
- `webui/src/components/workflow/interactions/InteractionHost.tsx`
- `webui/src/components/workflow/interactions/text-input/TextInputEnhanced.tsx`
- `webui/src/components/workflow/interactions/file-input/FileInputDropzone.tsx`
- `webui/src/components/workflow/interactions/structured-select/StructuredSelect.tsx`
- `webui/src/components/workflow/interactions/review-grouped/ReviewGrouped.tsx`
- `webui/src/components/workflow/interactions/form-input.tsx`
- `webui/src/components/workflow/interactions/file-download/FileDownload.tsx`

### Option B: Add `display_content` Field for Long Content

**Change:** Add a new `display_content` field to `InteractionRequest` for long-form content. `prompt` stays for short instructions. Child components render `display_content` in their scrollable area.

**Pros:**
- Clear semantic separation
- `prompt` keeps its original purpose
- Only modules with long content need changes

**Cons:**
- Adds complexity to `InteractionRequest`
- Requires server + client changes
- Need to update `user.pause` to use `display_content` instead of `prompt`

**Files affected:**
- `contracts/interactions.py` - add `display_content` field
- `server/api/models.py` - add `display_content` to API model
- `webui/src/lib/types.ts` - add `display_content` to TypeScript types
- `server/modules/user/pause.py` - use `display_content` for message
- `webui/src/components/workflow/interactions/text-input/TextInputEnhanced.tsx` - render `display_content`

### Option C: Conditional Scrolling in InteractionHost Based on Content Length

**Change:** Detect when `prompt` is long and apply scrollable styling conditionally.

**Pros:**
- Minimal code changes
- No contract changes

**Cons:**
- Arbitrary threshold for "long"
- Doesn't address the semantic issue
- Layout may shift unexpectedly

**Files affected:**
- `webui/src/components/workflow/interactions/InteractionHost.tsx`

## Recommendation

**Option A** is the cleanest architectural solution. It aligns with how `SchemaInteractionHost` already works - content is rendered inside the child's scrollable area, not in the parent container.

The key insight is: **title belongs in host, prompt/content belongs in child**.

## Priority

**Medium** - Affects user experience for `preview_aesthetic_prompt` but doesn't block workflow execution.

## Questions for Review

1. Should we proceed with Option A (move prompt to child components)?
2. Are there other interactions where long prompts are expected?
3. Should `title` also move to child components, or stay in host?
