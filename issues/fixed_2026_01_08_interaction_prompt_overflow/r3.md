# Issue: Remove `prompt` and `description` Fields from InteractionRequest

## Summary

We are removing `prompt` and `description` fields from `InteractionRequest`. All modules will use `title` for display. The `user.pause` module will be redesigned to use `TextInputEnhanced` in readonly mode for displaying content.

## Title vs Prompt Conflict Analysis

### Modules with NO Conflict

| Module | title | prompt | Resolution |
|--------|-------|--------|------------|
| `user.text_input` | (not set) | User input | Use `prompt` value as new `title` |
| `user.form` | `=prompt` | User input | Already same value, use `title` |
| `user.select` | `=prompt` | User input | Already same value, use `title` |
| `user.pause` | (not set) | Long content | Special case - redesign needed |

### Modules with CONFLICT

#### 1. `io.client_write` (client_write.py:133-137)

```python
title="Writing file",
prompt=f"Writing {filename} to project folder",
```

- **title**: Generic "Writing file"
- **prompt**: Specific "Writing {filename} to project folder"
- **Resolution**: Use `prompt` value as new `title` (more informative)

#### 2. `user.file_input` (file_input.py:121-126)

```python
title="File Input",
prompt=prompt,  # from workflow input
description=description,  # extension list
```

- **title**: Generic "File Input"
- **prompt**: Specific instruction from workflow (e.g., "Enter image file path")
- **description**: Extension list (e.g., "Allowed: .png, .jpg, .jpeg, .webp, .gif")
- **Resolution**: Use `prompt` value as new `title`. Move extension info to `display_data` or component handles it internally.

## Revised Implementation Plan

### Phase 1: Server-Side Changes

#### 1.1 Update `contracts/interactions.py`

Remove `prompt` and `description` fields from `InteractionRequest`:

```python
@dataclass
class InteractionRequest:
    interaction_type: InteractionType
    interaction_id: str

    # Display information
    title: str = ""  # Only title remains

    # ... rest unchanged
```

#### 1.2 Update Each Module

**`user.text_input` (text_input.py)**
```python
# Before
prompt=prompt,

# After
title=prompt,
```

**`user.select` (select.py)**
```python
# Before
prompt=prompt,
title=prompt,

# After
title=prompt,
```

**`user.form` (form.py)**
```python
# Before
prompt=prompt,
title=prompt,

# After
title=prompt,
```

**`user.file_input` (file_input.py)**
```python
# Before
title="File Input",
prompt=prompt,
description=description,

# After
title=prompt,
display_data={
    "extensions": extensions  # Move extension info here
}
```

**`io.client_write` (client_write.py)**
```python
# Before
title="Writing file",
prompt=f"Writing {filename} to project folder",

# After
title=f"Writing {filename} to project folder",
```

**`user.pause` - Special Redesign (see Phase 2)**

#### 1.3 Update `server/api/models.py`

Remove `prompt` and `description` from API models.

### Phase 2: Redesign `user.pause`

The `user.pause` module currently abuses `prompt` for long content display. New design:

**Approach: Use `default_value` for Content Display**

The existing `TextInputEnhanced` component already handles `default_value` - no special readonly mode needed. Just put the content in `default_value` and the existing component will display it in a scrollable textarea.

```python
# pause.py - new implementation
return InteractionRequest(
    interaction_type=InteractionType.TEXT_INPUT,
    interaction_id=f"pause_{uuid6.uuid7().hex}",
    title="Preview",
    default_value=full_message,  # Long content goes here as default value
    allow_empty=True,
    multiline=True,  # Enable multiline textarea for proper display
    context={
        "module_id": self.module_id,
        "pause": True
    }
)
```

The existing `TextInputEnhanced` component will display the content in a multiline textarea which is already scrollable.

### Phase 3: WebUI Changes

#### 3.1 Update `InteractionHost.tsx`

```tsx
// Before
{(request.title || request.prompt) && (
  <div className="flex-shrink-0 pb-4">
    {request.title && <h3>...</h3>}
    {request.prompt && <p>...</p>}
  </div>
)}

// After
{request.title && (
  <div className="flex-shrink-0 pb-4">
    <h3 className="text-lg font-semibold">{request.title}</h3>
  </div>
)}
```

#### 3.2 Update `TextInputEnhanced.tsx`

No changes needed. The existing component already:
- Handles `default_value` for pre-filled content
- Handles `multiline=true` with a scrollable textarea
- Works correctly for the pause module use case

#### 3.3 Update `FileInputDropzone.tsx`

Read extensions from `display_data` instead of `description`:

```tsx
const extensions = request.display_data?.extensions || request.accepted_types || [];
```

#### 3.4 Update `webui/src/lib/types.ts`

Remove `prompt` and `description` from `InteractionRequest` interface.

### Phase 4: TUI Changes

Update TUI strategies to not rely on `prompt` field:
- Each strategy gets display text from `title`
- `user.pause` content is in `default_value` - existing text_input strategy already handles this

## Files to Modify

| File | Change |
|------|--------|
| `contracts/interactions.py` | Remove `prompt`, `description` fields |
| `server/api/models.py` | Remove `prompt`, `description` from API model |
| `server/modules/user/text_input.py` | Use `title=prompt` |
| `server/modules/user/select.py` | Remove `prompt=`, keep `title=` |
| `server/modules/user/form.py` | Remove `prompt=`, keep `title=` |
| `server/modules/user/file_input.py` | Use `title=prompt`, move extensions to `display_data` |
| `server/modules/user/pause.py` | Use `default_value` for content, add `multiline=True` |
| `server/modules/io/client_write.py` | Use `title=` with specific message |
| `webui/src/lib/types.ts` | Remove `prompt`, `description` |
| `webui/src/components/workflow/interactions/InteractionHost.tsx` | Remove `prompt` rendering |
| `webui/src/components/workflow/interactions/file-input/FileInputDropzone.tsx` | Read extensions from `display_data` |
| `tui/strategies/*.py` | Update to use `title` instead of `prompt` |

## Migration Notes

- No backwards compatibility needed
- All workflow JSON files using `prompt` input on modules will continue to work (it's the module input, not the InteractionRequest field)
- The `prompt` workflow input gets mapped to `title` by each module

## Testing Checklist

- [ ] All select interactions show correct title
- [ ] Form input shows correct title
- [ ] Text input shows correct title
- [ ] File input shows correct title and extensions work
- [ ] File download shows specific filename in title
- [ ] Pause module displays long content in scrollable area
- [ ] TUI works with all interaction types
- [ ] WebUI works with all interaction types
