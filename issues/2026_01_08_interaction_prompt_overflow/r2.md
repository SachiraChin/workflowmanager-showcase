# Issue: `prompt` Field Misplaced in InteractionRequest Design

## Summary

The `prompt` field in `InteractionRequest` is rendered by `InteractionHost` (the parent container), but the host container should only render `title` and `description`. The `prompt` field's existence and placement reflects an incorrect design decision that conflates instructional text with displayable content.

## How This Came To Be

### The Three Display Fields in InteractionRequest

`contracts/interactions.py` defines three display fields:

```python
# Display information (what to show the user)
title: str = ""
prompt: str = ""
description: str = ""
```

**Intended semantics:**
- `title`: Short heading for the interaction
- `description`: Supplementary context (rarely used - not even rendered in WebUI!)
- `prompt`: Instructional text for the user

### How Modules Use These Fields

| Module | title | prompt | description | display_data |
|--------|-------|--------|-------------|--------------|
| `user.select` | `=prompt` | Short instruction | - | `{data, schema}` |
| `user.form` | `=prompt` | Short instruction | - | `{data, schema}` |
| `user.text_input` | - | Short instruction | - | - |
| `user.file_input` | "File Input" | Short instruction | Extension list | - |
| `user.pause` | - | **LONG CONTENT** | - | - |

**Key observations:**

1. `user.select` and `user.form` set `title=prompt` (redundant duplication)
2. `description` is almost never used and not rendered in WebUI
3. `user.pause` abuses `prompt` for long content because there's no proper content field

### The Incorrect Decision

`user.pause` was designed as a debugging/preview module that shows content before continuing. It:
1. Uses `InteractionType.TEXT_INPUT` (not a dedicated PAUSE type)
2. Puts all display content (message + debug info + jinja2 output) into `prompt`
3. Relies on `TextInputEnhanced` to just show an empty input field

This worked in TUI where text just flows, but breaks in WebUI where `InteractionHost` renders `prompt` in a fixed non-scrollable header area.

### Current WebUI Rendering

```
InteractionHost (renders title + prompt)
    └── Child Component (renders display_data)
```

`InteractionHost.tsx:106-116`:
```tsx
{(request.title || request.prompt) && (
  <div className="flex-shrink-0 pb-4">  {/* Non-scrollable! */}
    {request.title && <h3>...</h3>}
    {request.prompt && <p>...</p>}
  </div>
)}
```

Child components that need scrollable content use `display_data`:
```tsx
// SchemaInteractionHost.tsx:167 - correct pattern
<div className="flex-1 min-h-0 overflow-y-auto scrollbar-inner pr-2">
  <SchemaRenderer data={data} schema={schema} />
</div>
```

## Is `prompt` Really Needed?

**Analysis by interaction type:**

| Type | Current `prompt` Usage | Alternative |
|------|------------------------|-------------|
| `TEXT_INPUT` | "Enter your name" | Could be `placeholder` or child renders it |
| `SELECT_FROM_STRUCTURED` | "Select the theme" | Redundant with `title` (they're set to same value) |
| `REVIEW_GROUPED` | "Review the content" | Redundant with `title` |
| `FORM_INPUT` | "Fill out the form" | Redundant with `title` |
| `FILE_INPUT` | "Enter file path" | Could be child responsibility |

**Conclusion:** `prompt` is either:
1. Redundant with `title` (select, form)
2. Should be handled by child component (text_input, file_input)
3. Misused for content that belongs in `display_data` (pause)

## Where Should Instructional Text Belong?

Given the recursive component design where each child is an atomic component:

**Host Container should render:**
- `title` - the interaction heading

**Child Component should render:**
- Instructional text specific to that interaction type
- All displayable content from `display_data`
- Input fields, selection UI, etc.

This matches how `SchemaInteractionHost` works - it receives data via `display_data` and handles all rendering including selection counts, content display, etc.

## Proposed Solution

### Phase 1: Move `prompt` to Child Components

1. Remove `prompt` rendering from `InteractionHost`
2. Each child component renders its own instructional text from `request.prompt`
3. Child components place `prompt` in their scrollable content area

**Changes:**

`InteractionHost.tsx`:
```tsx
// Before
{(request.title || request.prompt) && (
  <div className="flex-shrink-0 pb-4">
    {request.title && <h3>...</h3>}
    {request.prompt && <p>...</p>}  // Remove this
  </div>
)}

// After
{request.title && (
  <div className="flex-shrink-0 pb-4">
    <h3 className="text-lg font-semibold">{request.title}</h3>
  </div>
)}
```

`TextInputEnhanced.tsx`:
```tsx
return (
  <div className="h-full flex flex-col">
    {/* Prompt - scrollable with content */}
    {request.prompt && (
      <div className="flex-1 min-h-0 overflow-y-auto mb-4">
        <p className="text-base text-foreground/80 whitespace-pre-line">
          {request.prompt}
        </p>
      </div>
    )}
    {/* Input field - fixed at bottom */}
    <div className="flex-shrink-0">
      {/* existing input UI */}
    </div>
  </div>
);
```

### Phase 2: Consider Removing `prompt` Entirely

For modules where `title=prompt`, we could:
1. Just use `title` for the heading
2. Use `display_data.instructions` for longer instructional text
3. Deprecate `prompt` field

### Phase 3: Fix `user.pause` Design

`user.pause` should either:
1. Use `display_data.content` for the message, not `prompt`
2. Have its own `PAUSE` interaction type with proper content handling
3. Be deprecated in favor of a proper "display content" module

## Files Affected

**Phase 1:**
- `webui/src/components/workflow/interactions/InteractionHost.tsx` - remove prompt rendering
- `webui/src/components/workflow/interactions/text-input/TextInputEnhanced.tsx` - add prompt rendering
- `webui/src/components/workflow/interactions/file-input/FileInputDropzone.tsx` - add prompt rendering
- `webui/src/components/workflow/interactions/structured-select/StructuredSelect.tsx` - already uses display_data, may need prompt
- `webui/src/components/workflow/interactions/form-input.tsx` - already uses display_data, may need prompt

**Phase 2/3 (future):**
- `contracts/interactions.py` - potentially deprecate `prompt`
- `server/modules/user/pause.py` - use `display_data` instead of `prompt`
- `server/api/models.py` - match contract changes
- `webui/src/lib/types.ts` - match contract changes

## Priority

**High** - This is a design issue that will cause problems for any interaction with long instructional text, not just `user.pause`.

## Questions for Review

<!--We are going ahead with removing prompt and description fields, without backwards compatibility. 
- all places apart from pause will use title, but there's any place with conflicting data for title and description, I want to know upfront
- user.pause module will use text module in readonly mode
-->

1. Should we proceed with Phase 1 (move prompt to children)?
2. Should `title` and `prompt` be consolidated into just `title`?
3. Should `user.pause` be redesigned to use `display_data` for content?
4. What about the unused `description` field - remove it?
