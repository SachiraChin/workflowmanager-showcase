# Issue: tui_path Uses Empty `requires` Instead of Explicit Capabilities

<!--agreed to fix this, albeit very low priority compared to others. -->

## Summary

The `tui_path` in execution groups uses `"requires": []` (empty array) instead of explicitly declaring the capabilities it needs. While this works due to priority-based selection, it's less clear and could cause issues if priority logic changes.

## Architecture Reference

- **R5 Part 1**: "Capability = Module ID" - Capabilities should reflect what modules are used
- **R5 Part 7**: Complete Example shows `tui_path` with `"requires": ["user.text_input", "transform.parse_pattern"]`
- **R8 Part 3**: Upload Flow - Flattener merges `requires` from all selected paths

## Expected Behavior (from R5)

### tui_path Definition

```json
{
  "name": "tui_path",
  "requires": ["user.text_input", "transform.parse_pattern"],
  "modules": [
    {
      "module_id": "user.text_input",
      "name": "get_aesthetic_input",
      ...
    },
    {
      "module_id": "transform.parse_pattern",
      "name": "parse_aesthetics",
      ...
    }
  ]
}
```

The `requires` array should list the capabilities (module IDs) that the path uses.

## Actual Behavior

### Current Implementation (07_aesthetic_selection_group.json:118-120)

```json
{
  "name": "tui_path",
  "requires": [],
  "modules": [...]
}
```

The `requires` is empty, meaning:
- TUI path "requires nothing" from client
- Selection is based purely on priority (webui_path has priority due to `user.form`)
- Any client matches tui_path since `[] ⊆ any_capabilities`

## Root Cause Analysis

### Why Empty Works (Currently)

The priority system (R9) ensures correct selection:

1. **webui_path**: `requires: ["user.form"]` with higher priority (listed first)
2. **tui_path**: `requires: []` with lower priority (listed second)

When selecting:
- WebUI has `user.form` → matches webui_path → uses webui_path (higher priority)
- TUI lacks `user.form` → doesn't match webui_path → falls through to tui_path

### Why Empty is Problematic

1. **Semantic Incorrectness**: TUI path DOES require `user.text_input`, it just doesn't declare it
2. **Priority Dependence**: Only works because webui_path is listed first
3. **No Validation**: Can't validate that TUI client actually has required capabilities
4. **Documentation**: Doesn't self-document what the path needs

### Why It Was Done This Way

Likely a simplification during implementation:
- Developer realized TUI is "default fallback" when WebUI-specific paths don't match
- Empty requires achieves this without listing every TUI capability
- Worked correctly, so wasn't revisited

## Impact

### Current Impact

**Minimal** - The system works correctly due to priority-based selection.

### Potential Future Issues

1. **Priority Changes**: If group order changes, wrong path may be selected
2. **Capability Validation**: Can't enforce that TUI actually supports required modules
3. **New Clients**: A third client type might incorrectly match tui_path
4. **Debugging**: Harder to understand why a path was selected when requires is empty

## Proposed Solution(s)

### Solution 1: Add Explicit Requires (Recommended)

Update tui_path to declare its actual requirements:

```json
{
  "name": "tui_path",
  "requires": [
    {"capability": "user.text_input", "priority": 40}
  ],
  "modules": [...]
}
```

**Benefits:**
- Self-documenting
- Matches architecture specification
- Validates client capabilities
- Works correctly with any priority ordering

### Solution 2: Add Comment/Documentation

If keeping empty requires for "default path" semantic:

```json
{
  "name": "tui_path",
  "requires": [],
  "_comment": "Empty requires = default fallback path for any client",
  "modules": [...]
}
```

This documents the intent but doesn't add validation.

## Files Affected

1. **workflows/oms/steps/1_user_input/modules/07_aesthetic_selection_group.json** - Update tui_path requires

## Priority

**Low (Nice to Have)**

**Justification:**
- Current behavior is correct
- Only affects code clarity and future-proofing
- No functional impact
- Can be addressed as part of workflow cleanup

## Testing Plan

1. Update tui_path with explicit requires
2. Test TUI client selection still works correctly
3. Test WebUI client still uses webui_path
4. Verify flattener handles updated requires correctly
5. Check generated resolutions have correct merged requires
